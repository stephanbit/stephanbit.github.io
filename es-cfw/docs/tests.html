<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tests and Mocking the API | ES Client Framework 3.0</title>
    <meta name="description" content="Client Framework to build SPAs based on VueJS 3">
    <link rel="icon" href="/es-cfw/logo.gif">
    
    <link rel="preload" href="/es-cfw/assets/css/0.styles.5b5d1efb.css" as="style"><link rel="preload" href="/es-cfw/assets/js/app.bf3be639.js" as="script"><link rel="preload" href="/es-cfw/assets/js/14.5d1022e0.js" as="script"><link rel="prefetch" href="/es-cfw/assets/js/10.bf477fb3.js"><link rel="prefetch" href="/es-cfw/assets/js/11.d6dc3fb0.js"><link rel="prefetch" href="/es-cfw/assets/js/12.7268368a.js"><link rel="prefetch" href="/es-cfw/assets/js/13.eb82dbdb.js"><link rel="prefetch" href="/es-cfw/assets/js/15.159ea840.js"><link rel="prefetch" href="/es-cfw/assets/js/16.cfaa7e90.js"><link rel="prefetch" href="/es-cfw/assets/js/17.2c15fe21.js"><link rel="prefetch" href="/es-cfw/assets/js/2.844c731f.js"><link rel="prefetch" href="/es-cfw/assets/js/3.3123983f.js"><link rel="prefetch" href="/es-cfw/assets/js/4.49d1c260.js"><link rel="prefetch" href="/es-cfw/assets/js/5.aa90e238.js"><link rel="prefetch" href="/es-cfw/assets/js/6.236040dd.js"><link rel="prefetch" href="/es-cfw/assets/js/7.f3703dd6.js"><link rel="prefetch" href="/es-cfw/assets/js/8.7f3a8669.js"><link rel="prefetch" href="/es-cfw/assets/js/9.d4c22c9c.js">
    <link rel="stylesheet" href="/es-cfw/assets/css/0.styles.5b5d1efb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/es-cfw/" class="home-link router-link-active"><!----> <span class="site-name">ES Client Framework 3.0</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/es-cfw/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://bitbucket.easy.de/scm/esc/es-cfw.git" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Bitbucket
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/es-cfw/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://bitbucket.easy.de/scm/esc/es-cfw.git" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Bitbucket
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/es-cfw/" class="sidebar-link">Introduction</a></li><li><a href="/es-cfw/docs/development.html" class="sidebar-link">Setup and Development</a></li><li><a href="/es-cfw/docs/components.html" class="sidebar-link">Development Components</a></li><li><a href="/es-cfw/docs/architecture.html" class="sidebar-link">Project Structure</a></li><li><a href="/es-cfw/docs/tech.html" class="sidebar-link">Languages and Technologies</a></li><li><a href="/es-cfw/docs/routing.html" class="sidebar-link">Routing, Layouts and Views</a></li><li><a href="/es-cfw/docs/state.html" class="sidebar-link">State Management</a></li><li><a href="/es-cfw/docs/ui_components.html" class="sidebar-link">UI Components</a></li><li><a href="/es-cfw/docs/fun_components.html" class="sidebar-link">FUN Components</a></li><li><a href="/es-cfw/docs/tests.html" class="active sidebar-link">Tests and Mocking the API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es-cfw/docs/tests.html#running-all-tests" class="sidebar-link">Running all Tests</a></li><li class="sidebar-sub-header"><a href="/es-cfw/docs/tests.html#unit-tests-with-jest" class="sidebar-link">Unit Tests with Jest</a></li><li class="sidebar-sub-header"><a href="/es-cfw/docs/tests.html#end-to-end-tests-with-nightwatch-available-in-beta-release" class="sidebar-link">End-to-End Tests with Nightwatch (available in beta release!)</a></li><li class="sidebar-sub-header"><a href="/es-cfw/docs/tests.html#the-mock-api" class="sidebar-link">The Mock API</a></li></ul></li><li><a href="/es-cfw/docs/linting.html" class="sidebar-link">Linting &amp; Formatting</a></li><li><a href="/es-cfw/docs/editors.html" class="sidebar-link">Editor integration</a></li><li><a href="/es-cfw/docs/production.html" class="sidebar-link">Build and Deploy to Production</a></li><li><a href="/es-cfw/docs/troubleshooting.html" class="sidebar-link">Troubleshooting</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="tests-and-mocking-the-api"><a href="#tests-and-mocking-the-api" aria-hidden="true" class="header-anchor">#</a> Tests and Mocking the API</h1> <ul><li><a href="#tests-and-mocking-the-api">Tests and Mocking the API</a> <ul><li><a href="#running-all-tests">Running all Tests</a></li> <li><a href="#unit-tests-with-jest">Unit Tests with Jest</a> <ul><li><a href="#running-unit-tests">Running Unit Tests</a></li> <li><a href="#introduction-to-jest">Introduction to Jest</a></li> <li><a href="#unit-test-files">Unit Test Files</a></li> <li><a href="#unit-test-helpers">Unit Test Helpers</a></li> <li><a href="#unit-test-mocks">Unit Test Mocks</a></li></ul></li> <li><a href="#end-to-end-tests-with-nightwatch">End-to-End Tests with Nightwatch</a> <ul><li><a href="#running-end-to-end-tests">Running end-to-end Tests</a></li> <li><a href="#introduction-to-nightwatch">Introduction to Nightwatch</a></li> <li><a href="#accessibility-driven-end-to-end-tests">Accessibility-driven end-to-end Tests</a></li></ul></li> <li><a href="#the-mock-api">The Mock API</a> <ul><li><a href="#testingdeveloping-against-a-real-server">Testing/Developing against a real Server</a></li></ul></li></ul></li></ul> <h2 id="running-all-tests"><a href="#running-all-tests" aria-hidden="true" class="header-anchor">#</a> Running all Tests</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Run all tests</span>
yarn <span class="token function">test</span>
</code></pre></div><h2 id="unit-tests-with-jest"><a href="#unit-tests-with-jest" aria-hidden="true" class="header-anchor">#</a> Unit Tests with Jest</h2> <h3 id="running-unit-tests"><a href="#running-unit-tests" aria-hidden="true" class="header-anchor">#</a> Running Unit Tests</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Run unit tests</span>
yarn unit

<span class="token comment"># Run unit tests in watch mode</span>
yarn unit:watch
</code></pre></div><h3 id="introduction-to-jest"><a href="#introduction-to-jest" aria-hidden="true" class="header-anchor">#</a> Introduction to Jest</h3> <p>For unit tests, we use Jest with the <code>describe</code>/<code>expect</code> syntax. If you're not familiar with Jest, I recommend first browsing through the existing tests to get a sense for them.</p> <p>Then at the very least, read about:</p> <ul><li><a href="https://facebook.github.io/jest/docs/en/expect.html" target="_blank" rel="noopener noreferrer">Jest's matchers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for examples of other assertions you can make</li> <li><a href="https://facebook.github.io/jest/docs/en/asynchronous.html" target="_blank" rel="noopener noreferrer">Testing async code<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://facebook.github.io/jest/docs/en/setup-teardown.html" target="_blank" rel="noopener noreferrer">Setup and teardown<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="unit-test-files"><a href="#unit-test-files" aria-hidden="true" class="header-anchor">#</a> Unit Test Files</h3> <p>Configuration for Jest is in <code>jest.config.js</code>, support files are in <code>tests/unit</code>, but as for the tests themselves - they're first-class citizens. That means they live alongside our source files, using the same name as the file they test, but with the extension <code>.unit.js</code>. This may seem strange at first, but it makes poor test coverage obvious from a glance, even for those less familiar with the project. It also lowers the barrier to adding tests before creating a new file, adding a new feature, or fixing a bug.</p> <h3 id="unit-test-helpers"><a href="#unit-test-helpers" aria-hidden="true" class="header-anchor">#</a> Unit Test Helpers</h3> <p>See <a href="../tests/unit/setup.js"><code>tests/unit/setup.js</code></a> for a list of helpers, including documentation in comments.</p> <h3 id="unit-test-mocks"><a href="#unit-test-mocks" aria-hidden="true" class="header-anchor">#</a> Unit Test Mocks</h3> <p>Jest offers many tools for mocks, including:</p> <ul><li><a href="https://facebook.github.io/jest/docs/en/mock-functions.html" target="_blank" rel="noopener noreferrer">For a function<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, use <code>jest.fn()</code>.</li> <li><a href="https://facebook.github.io/jest/docs/en/manual-mocks.html#mocking-user-modules" target="_blank" rel="noopener noreferrer">For a source file<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, add the mock to a <code>__mocks__</code> directory adjacent to the file.</li> <li><a href="https://facebook.github.io/jest/docs/en/manual-mocks.html#mocking-node-modules" target="_blank" rel="noopener noreferrer">For a dependency in <code>node_modules</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, add the mock to <code>tests/unit/__mocks__</code>. You can see an example of this with the <code>axios</code> mock, which intercepts requests with relative URLs to either <a href="#the-mock-api">our mock API</a> or a local/live API if the <code>API_BASE_URL</code> environment variable is set.</li></ul> <h2 id="end-to-end-tests-with-nightwatch-available-in-beta-release"><a href="#end-to-end-tests-with-nightwatch-available-in-beta-release" aria-hidden="true" class="header-anchor">#</a> End-to-End Tests with Nightwatch (available in beta release!)</h2> <h3 id="running-end-to-end-tests"><a href="#running-end-to-end-tests" aria-hidden="true" class="header-anchor">#</a> Running end-to-end Tests</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Run end to end tests</span>
yarn e2e

<span class="token comment"># Run the dev server with the nightwatch client</span>
yarn dev:e2e
</code></pre></div><h3 id="introduction-to-nightwatch"><a href="#introduction-to-nightwatch" aria-hidden="true" class="header-anchor">#</a> Introduction to Nightwatch</h3> <p>Nightwatch offers many advantages over other test frameworks, including the abilities to:</p> <ul><li><a href="#core-concepts">Core Concepts</a></li> <li><a href="#best-practice">Best Practices</a></li></ul> <div class="language-js extra-class"><pre class="language-js"><code># <span class="token punctuation">(</span>available <span class="token keyword">in</span> beta release<span class="token operator">!</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="accessibility-driven-end-to-end-tests"><a href="#accessibility-driven-end-to-end-tests" aria-hidden="true" class="header-anchor">#</a> Accessibility-driven end-to-end Tests</h3> <h2 id="the-mock-api"><a href="#the-mock-api" aria-hidden="true" class="header-anchor">#</a> The Mock API</h2> <p>Working against the production API can be useful sometimes, but it also has some disadvantages:</p> <ul><li>Networks requests are slow, which slows down both development and testing.</li> <li>Development and testing become dependent on a stable network connection.</li> <li>Hitting the production API often means modifying the production database, which you typically don't want to do during automated tests.</li> <li>To work on a frontend feature, the backend for it must already be complete.</li></ul> <p>The mock API is an <a href="https://expressjs.com/" target="_blank" rel="noopener noreferrer">Express<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> server in <code>tests/mock-api</code> you can extend to - you guessed it - mock what the real API would do, solving all the problems listed above. This solution is also backend-agnostic, making it ideal for a wide variety of projects.</p> <h3 id="testing-developing-against-a-real-server"><a href="#testing-developing-against-a-real-server" aria-hidden="true" class="header-anchor">#</a> Testing/Developing against a real Server</h3> <p>In some situations, you might prefer to test against a local server while developing, or maybe just during continuous integration. To do so, you can run any development or test command with the <code>API_BASE_URL</code> environment variable. For example:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>API_BASE_URL<span class="token operator">=</span>http://localhost:3000 yarn <span class="token function">test</span>
</code></pre></div><p>Or similarly, with a live server:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>API_BASE_URL<span class="token operator">=</span>https://staging.example.io yarn <span class="token function">test</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/es-cfw/docs/fun_components.html" class="prev">
          FUN Components
        </a></span> <span class="next"><a href="/es-cfw/docs/linting.html">
          Linting &amp; Formatting
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/es-cfw/assets/js/14.5d1022e0.js" defer></script><script src="/es-cfw/assets/js/app.bf3be639.js" defer></script>
  </body>
</html>
